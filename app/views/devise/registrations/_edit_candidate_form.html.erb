<%= simple_form_for(@user, method: :patch, url: candidates_user_profile_path(@user), html: { multipart: true }) do |f| %>
<div class="columns candidate-user-form">
  <div class="column is-4 has-text-centered">
    <h1 class="title is-5"> <%= t('my_profile') %> </h1>
    <% if current_user.picture_url.file.nil? %>
      <%= icon('far', 'user-circle', style: 'font-size: 100px') %>
    <% else %>
      <div class="rounded-image m-auto size-120">
        <%= image_tag(current_user.picture_url, alt: "Imagen perfil usuario | Wearehiring.io") %>
      </div>
    <% end %>
    <p class="title f4 mt4"> 
      <%= current_user.name %> 
    </p>
    <p> 
      <%= current_user.current_position %> 
    </p>
    <p> 
      <%= icon('far', 'paper-plane') %>
      <%= mail_to current_user.email %> 
    </p>
    <p class="mt4">
      <%= icon('fab', 'get-pocket') %>
      <%= link_to "#{current_user.inscriptions.count} Jobs aplicados", candidates_inscriptions_path(current_user.id), target: "_blank" %>
    </p>
    <div class="file justify-center is-normal mt4">
      <label class="file-label">
        <%= f.input :picture_url, as: :file, required: false, input_html: { class: "file-input load-image" }, label: false, wrapper: false %>
        <span class="file-cta">
          <span class="file-icon"> <%= icon('fas', 'upload') %> </span>
          <span class="file-label"> Cambiar imagen... </span>
        </span>
      </label>
    </div>
    <small> Tamaño mínimo recomendado 200x200 </small>
    <output id="list"></output>
  </div>
  <div class="column is-8">
    <div class="we-match-box mb3">
      <div class="columns">
        <div class="column">
          <p class="title is-4"> We Match <span class="tag is-info is-light"> ¡Nuevo! </span> </p>
        </div>
        <div class="column">
          <div class="toggleWrapper">
            <%= f.check_box :visible, checked: f.object.visible, class: 'activate-we-match' %>
            <%= f.label :visible, class: 'toggle' do %>
              <span class="toggle__handler"></span>
            <% end %>
          </div>
        </div>
      </div>
      <div class="field mt4">
        <%= f.label t('skills.title'), class: 'has-text-weight-bold' %>
        <div class="control">
          <small> <%= t('skills.job_subtitle') %> </small>
          <%= f.collection_select :skill_ids, Skill.all, :id, :name, {}, { multiple: "multiple", class: "skills-select", style: "width: 100%"} %>  
        </div>
      </div>
      <div class="field mt4">
        <strong> <%= t('users.salary_expectation') %> </strong>  
      </div>
      <div class="columns">
        <div class="column is-one-quarter-desktop">
          <div class="field">
            <div class="control">
              <%= f.input_field :salary_from, class: 'input', placeholder: '30000' %>
              <small> <%= t('forms.from') %> </small>
            </div>
          </div>
        </div>
        <div class="column is-one-quarter-desktop">
          <div class="field">
            <div class="control">
              <%= f.input_field :salary_to, class: 'input', placeholder: '40000' %>
              <small> <%= t('forms.to') %> </small>
            </div>
          </div>
        </div>
      </div>
      <div class="has-text-right">
        <%= f.button :submit, t('save'), class:"button is-info mt2" %>
      </div>
    </div>
    <hr>
    <h2 class="title is-4 mt4"> <%= t('important_info_for_the_recruiter') %> </h2>
    <div class="columns">
      <div class="column">
        <div class="field">
          <%= f.label :name, class: 'has-text-weight-bold' %>
          <div class="control mt2">
            <%= f.input :name, 
              input_html: { class: "input" }, 
              placeholder: "Carlos", 
              label: false, 
              wrapper: false %>
          </div>
        </div>
      </div>
      <div class="column">
        <div class="field">
          <%= f.label :last_name, class: 'has-text-weight-bold' %>
          <div class="control mt2">
            <%= f.input :last_name, 
              input_html: { class: "input" }, 
              placeholder: "Hernández", 
              label: false, 
              wrapper: false %>
          </div>
        </div>
      </div>
    </div>
    <div class='has-text-weight-bold mb2'>
      <%= t('users.phone') %>
      <%= content_tag(:span, nil, class: 'dot-notification') if current_user.phone.blank? %>
    </div>
    <% if current_user.phone.blank? %>
      <span class="f6 primary-color"> Añade tu <strong class="primary-color"> teléfono </strong> y aumenta las posibilidades de ser contactado </span>
    <% end %>
    <div class="field">
      <div class="control has-icons-left">
        <%= f.input :phone, 
          label: false,
          hint: "Solo las empresas donde apliques verán tu teléfono", 
          input_html: { class: "input" }, 
          wrapper: false, 
          placeholder: "+34 666555444" %>
        <span class="icon is-small is-left">
          <%= icon('fas', 'phone') %>
        </span>
      </div>
    </div>
    <div class='has-text-weight-bold mb2'>
      <%= t('users.profile_url') %>
      <%= content_tag(:span, nil, class: 'dot-notification') if current_user.profile_url.blank? %>
    </div>
    <div class="field">
      <div class="control has-icons-left">
        <%= f.input :profile_url, 
          label: false,
          input_html: { class: "input" }, 
          wrapper: false, 
          placeholder: "https://www.linkedin.com/in/your-profile-url/" %>
        <span class="icon is-small is-left">
          <%= icon('fab', 'linkedin') %>
        </span>
      </div>
    </div>
    <div class='has-text-weight-bold mb2'>
      <%= t('users.current_position') %>
      <%= content_tag(:span, nil, class: 'dot-notification') if current_user.current_position.blank? %>
    </div>
    <div class="field">
      <div class="control">
        <%= f.input :current_position, 
          label: false,
          input_html: { class: "input" }, 
          wrapper: false, 
          placeholder: "Marketing digital" %>
      </div>
    </div>

    <h2 class="title is-4 mt4"> <%= t('complementary_info') %> </h2>

    <div class="field">
      <%= f.label t('about_me'), class: 'has-text-weight-bold' %>
      <div class="control">
        <%= f.input :description, 
          input_html: { class: "input textarea mt2" }, 
          placeholder: "Háblanos un poco sobre ti", 
          label: false, 
          wrapper: false %>
      </div>
    </div>

    <div class="field">
      <%= f.label :github, class: 'has-text-weight-bold' %>
      <div class="control has-icons-left mt2">
        <%= f.input :github, 
          input_html: { class: "input" }, 
          placeholder: "github/yourprofile", 
          label: false, 
          wrapper: false %>
        <span class="icon is-small is-left">
          <%= icon('fab', 'github') %>
        </span>
      </div>
    </div>

    <div class="field">
      <%= f.label :pinterest, class: 'has-text-weight-bold' %>
      <div class="control has-icons-left mt2">
        <%= f.input :pinterest, 
          input_html: { class: "input" }, 
          placeholder: "pinterest/yourprofile", 
          label: false, 
          wrapper: false %>
        <span class="icon is-small is-left">
          <%= icon('fab', 'pinterest') %>
        </span>           
      </div>
    </div>

    <div class="field">
      <%= f.label :behance, class: 'has-text-weight-bold' %>
      <div class="control has-icons-left mt2">
        <%= f.input :behance, 
          input_html: { class: "input" }, 
          placeholder: "behance/yourprofile", 
          label: false, 
          wrapper: false %>
        <span class="icon is-small is-left">
          <%= icon('fab', 'behance-square') %>
        </span>        
      </div>
    </div>

    <div class="field">
      <%= f.label :personal_website, class: 'has-text-weight-bold' %>
      <div class="control has-icons-left mt2">
        <%= f.input :personal_website, 
          input_html: { class: "input" }, 
          placeholder: "https://yourwebsite.com", 
          label: false, 
          wrapper: false %>
        <span class="icon is-small is-left">
          <%= icon('far', 'window-restore') %>
        </span>        
      </div>
    </div>

    <%= f.button :submit, t('save'), class:"button is-info is-pulled-right mt3" %>
  </div>
</div>
<% end %>

<%= content_for :head do %>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
<% end %>

<%= content_for :footer do %>
  <%= javascript_include_tag "helpers/image_loader.js" %>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>

  <script>  
    $(document).ready(function() {
      $('.skills-select').select2();
    });

    $(".activate-we-match").change(function(){
      $("form").submit();
    });

  </script>
<% end %>